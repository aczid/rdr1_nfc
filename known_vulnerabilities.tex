%\chapter{Known Vulnerabilities}
%\label{chap:known_vulnerabilities}
\section{Security research}

While consumers might see NFC applications as a gadget that will make their lives easier, this development towards contactless payment systems has raised questions from security researchers.
%TODO Summarize and reference some security research done on RFID.

Because NFC will be used in payment and access control, it should be assumed that attackers will try to exploit this technology.
NFC's security features have been the subject of research and some of attacks found possible which will be summarized below.
Because NFC will be used in payment and access control, it should be assumed that attackers will try to exploit this technology for their own gain. 
%Research has been done on the security of NFC in several areas, among which:

% TODO Referenties toevoegen
%\begin{itemize}
%\item Creating secure off-line payment applications \cite{1592613}
%\item Trusted computing using mobile applications which are managed remotely
%\item Network attacks against \textit{Wireless Personal Area} (WPAN) \textit{Networks} (e.g \textit{Denial of Service}, \textit{Snooping}, \textit{Man-in-the-middle}, etc.) \footnote{Even though NFC isn't strictly a WPAN system as it only allows for 2 communicating parties, this paper also covers network attacks against NFC.}  \cite{1506342}
%\item Intrusion detection mechanisms for WPANs \cite{1361512}
%\item Mitigations agains privacy issues related to wireless payment systems \cite{1527027}
%\end{itemize}

\subsection{Relay attacks}
% TODO
% Maar de NFC telefoon heeft toetsenbord (om actieve approval vd eigenaar te vragen (en te zeggen hoeveel er betaald gaat worden)
RFID, a direct ancestor of NFC, is prone to relay attacks.
A relay attack is a combination of a man-in-the-middle and relay attack.
The goal is that the attacker will gain something, but victim will lose something, e.g. the attackers will get a product from a retailer, but the victim is the one who is paying. 

To achieve a relay attack, the attacker will need a device that emulates an RFID card (called the \textit{ghost}), and a device that acts as an RFID reader (called the \textit{leech}).
The \textit{ghost} will be used to communicate with a genuine reader and the \textit{leech} will be used communicate with a genuine card (the victim).
The attacker must trick the user into making a legitimate purchase, and have the devices set up in such a way that they operate on much larger distance then the normal operational distance of 10 centimeters, so that the attack will go unnoticed. \cite{1128470}

For example, with this attack it could be possible to gain access to public transport.
The check-in gate will communicate with the ghost, which relay the communication on to the leech, which will then relay it to the victim and vice versa.
The check-in gate will conclude it is communicating with the victim, but because the attacker is closer to the gate than the victim, he will gain access first and the victim will pay.

\subsection{Countermeasures against relay attacks}
There are three possible countermeasures, a Faraday-cage, interactive confirmation to activate by the user or Two-Factor authentication.
A Faraday-cage \footnote{A Faraday cage is a room or mesh made out of a conducting material e.g. copper. This will block out electric fields.}  will block all RF communication, so an attacker can not make contact with the device.
% TODO faraday cage uitleggen
This is not a feasible countermeasure for a mobile phone, because it will not have any connectivity.
Interactive confirmation to activate the connection will defend the user from accidentally making a transaction.
%The user will have to confirm NFC on the device, to be able to e.g. make a payment or use public transport.
It will not be possible for an attacker to use the phone at all times.
This will slightly decrease the user friendliness, because there will be an extra step for user to switch the NFC feature on.
With Two-Factor authentication, the user will be asked to present something, e.g. a password, pincode or token.
NFC will be turned on all the time, but only when it will be used, the user will type the pincode and a connection is made.
The attacker can actually notify the user, that a connection will be made.
If the user is aware that the NFC connection is not necessary (because he is not near a payment terminal) and declines or does not type the password, the attack is avoided.
This countermeasure will also decrease user friendliness. \cite{1128470}

Overall the relay attack on NFC will have lower feasibility than relay attacks on RFID cards, precisely because the user is presented with the option of accepting or declining transactions.

Another countermeasure against a relay attack is the use of a distance bouding protocol. This makes sure that both communicating parties are in the allowed range of each other. To achieve this the \textit{Verifier} e.g. an NFC enable device, sends a challenge e.g. a certain amount of bits, to the \textit{Prover} e.g. a payment terminal. The Prover processes the challenge and replies back to the Verifier. The Verifier will then calculate the round-trip time between the sending of the challenge and the recieving of the reply from the Prover. By substracting the Prover's processing time from the round-trip time, the distance bound between the two devices is determined. 
Because the Prover has to process the challenge, it can not send anything sooner then it recieves. This means that the Prover can not fake to be closer to the Verifier then it really is.
With a distance bounding protocol it will become possible for a NFC enable mobile device (Verifier), to check if the payment terminal or access gate (Prover) is within a set distance. For NFC this will ideally be 10cm, as this is the specified operational distance. \cite{rasmussenrealization,brands1994distance}

%plaatje relay attack

% 2 verschillende scenario's relay attack
% I - stiekem met iemand z'n kaart praten
% II - een frauduleus/gemhackte terminal neerzetten waar iemand - willens en wetens - z'n kaart tegenaan houdt.

\subsection{Malware distribution}
Smart poster technology can be used to distribute malware.
It has proven to be possible to mislead a user to visit a malicious website through a modified NFC-tag.
In a technique using \textit{Smart poster Uniform Resource Identifier spoofing}, an attacker could modify the title of a message containing a malicious URI using whitespace characters like space, tab and new line characters so that it looks innocent to the user.
The actual URI in the message is not shown to user, but the user is still directed there upon receiving the communication from the smart poster.
%The user is unaware that he or she is directed to a malicious website, from where a number of further attacks are possible.
%In the same way it is possible to let the user call or send a text message to a different number, e.g. an 0900-number.
The different services a user can be directed to through URI spoofing, depends on the browser attacked, but could include the World Wide Web, file sharing, instant messaging, (internet) telephony or text messaging.

It is also possible to hide and spread a computer worm in this manner.
For such a worm to propagate, the phone of the user has to be infected with the worm. When the phone reads a tag, it will try to change it, like described above. The next user that reads the tag will be pointed to a website, where he will be tricked into downloading and installing a copy of the worm.

\cite{mulliner2009vulnerability,rieback2006your} 

\subsection{Countermeasures against malware distribution}
This vector is similar to other networking attacks, the best defense against these kinds of attacks is user vigilance in spotting malicious messages.
These attacks can possibly be mitigated against by taking preventive measures in the client software.

\subsection{Differential Power Analysis Attack}
A Differential Power Analysis (DPA) attack is a form of side channel attack.
A side channel attack is based on information that can be collected by analysing the physical operation of a cryptographical system (cryptosystem) e.g. by analysing the power usage, electromagnetic radiation leakage or timing of a cryptosystem.
It is possible to prevent this from happening by implementing extra shielding, filtering inputs and outputs.
DPA attacks are a problem for devices where the cryptosystem has to be small, cheap and have low power usage (like the secure elements used in NFC).

With DPA the power consumption is measured to extract information about the workings of the cryptosystem.
To measure the power consumption an analog to digital converter is used.
When the cryptosystem is processing, the power usage will vary during the different operations.
The information is statistically analyzed to determine the key or plaintext, or it can give information about the key, which can help to speed up the attack or help a different attack to succeed.

DPA can also be applied for electromagnetic radiation.
Information about the crytposystem can be collected from the RF noise given off by the electronic signals representing the data travelling to and from the secure element and memory.
All these fluctuations in the integrated circuit, wires and electromagnetic radiation can provide information to be analyzed to yield some information about the key or secret data.

One measurement of these variations might not be enough to produce the entire key, because of noise (e.g. inaccuries, outside influence) that is collected during the measurement, which will provide no information about the key.
Therefore several measurements are necessary to distinguish the signal from the noise.
By aligning the measurements, an attacker can compare data on single points of interest.
By averaging the collected data, the usable signal is amplified and the noise is filtered out.

Another way to collect information about the key, besides taking many different measurements, is changing some bits of the key to check if the changes might reveal some information about the encryption process.
This technique can also be repeated and the resulting data statistically analyzed to get the key.
Also by resetting or switching off the power during a specific operation, which can be repeated, information about the key might be collected. \cite{kocher2009differential}

\subsection{Countermeasures Differential Power Analysis}
A DPA attack is successful if enough information can be collected to retrieve the key in the cryptosystem.
By increasing the number of measurements, it will take more time to collect the information needed to retrieve the key. 
There are several ways to increase the number of measurements required.
For example, randomly generated noise can be added to the operations of the cryptosystem, which will make it harder to filter out the signal from the noise, because more measurements are needed.
Another way is to reduce the signal size, making it harder to pick up. 
If the cryptosystem is designed to self-destruct after a certain amount of operations and the number of measurements needed to retrieve the key is higher then amount of operations, this adds another level of defense against an attacker retrieving the key.

Another countermeasure to prevent information from being collected is clock skipping.
Normally a cryptosystem uses an external clock for its processing.
With clock skipping an internal clock is used in the cryptosystem.
This will create more noise and will prevent the attacker from aligning the points of interest in the collected data and making it more difficult to identify the signal. 

A countermeasure that can also be effective against DPA is, to use a random number generator to add an amount of unpredictability in the order in which the crypto operations are executed.
The result is that it will be harder for the attacker to find the points of interest in the collected data, making it more difficult to extract the key. \cite{kocher2009differential}

% ERIk open platform vs gesloten platform

\subsection{Denial of Service}
A denial of service attack is also possible, with the goal to let users stop using the service. By using a tag that sends out malformed messages, taped on top of the original tag, the phone of the user will crash when he attempts to read the tag.
By putting a e.g. copper wire or mesh sticker on top of a tag or a terminal, it is possible to create a small Faraday cage, preventing the terminal to send out its RF signal or reducing the range of the signal. \cite{rieback2006your}

\subsection{Countermeasures Denial of Service}
There are not many countermeasures that you can take to prevent an attack like this. As suggested before, preventive measures taken in client software, might help dealing with malformed messages. 
As for Faraday cages in sticker form, only regular checking of the original equipment used, will reduce the impact.

%TODO Countermeasures
